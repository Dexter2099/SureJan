<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ post.title }}</title>
    <link rel="stylesheet" href="/static/css/old.css">
</head>
<body>
    <h1>{{ post.title }}</h1>
    {% if post.post_type == 'text' and post.body %}
    <p>{{ post.body }}</p>
    {% elif post.post_type == 'link' %}
    <p><a href="{{ post.url }}">{{ post.url }}</a></p>
    {% endif %}
    <p>
        in <a href="{% url 'community' post.community.name %}" style="color: blue;">{{ post.community.title }}</a>
        by {{ post.author.username }}
        ·
        <button hx-post="{% url 'vote_post' post.pk %}"
                hx-target="#post-score-{{ post.pk }}"
                hx-swap="outerHTML"
                hx-include="[name='v']">
            ▲<input type="hidden" name="v" value="1">
        </button>
        <span id="post-score-{{ post.pk }}">{{ post.score }}</span>
        <button hx-post="{% url 'vote_post' post.pk %}"
                hx-target="#post-score-{{ post.pk }}"
                hx-swap="outerHTML"
                hx-include="[name='v']">
            ▼<input type="hidden" name="v" value="-1">
        </button>
        · {{ post.created_at|timesince }} ago
    </p>
    <h2>Comments</h2>
    <ul>
        {% for comment in comments %}
        <li>
            <p>{{ comment.body }}</p>
            <small>
                by {{ comment.author.username }}
                ·
                <button hx-post="{% url 'vote_comment' comment.pk %}"
                        hx-target="#comment-score-{{ comment.pk }}"
                        hx-swap="outerHTML"
                        hx-include="[name='v']">
                    ▲<input type="hidden" name="v" value="1">
                </button>
                <span id="comment-score-{{ comment.pk }}">{{ comment.score }}</span>
                <button hx-post="{% url 'vote_comment' comment.pk %}"
                        hx-target="#comment-score-{{ comment.pk }}"
                        hx-swap="outerHTML"
                        hx-include="[name='v']">
                    ▼<input type="hidden" name="v" value="-1">
                </button>
                · {{ comment.created_at|timesince }} ago
            </small>
        </li>
        {% empty %}
        <li>No comments yet.</li>
        {% endfor %}
    </ul>
    <h3>Add comment</h3>
    <form method="post" action="{% url 'add_comment' post.pk %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Comment</button>
    </form>
</body>
</html>
